#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <sstream>
#include <random>
#include <algorithm>
#include <unordered_set>
#include <utility>
#include <time.h>
using namespace std;


class ColoringProblem
{
public:
    int GetRandom(int a, int b)
    {
        static mt19937 generator;
        uniform_int_distribution<int> uniform(a, b);
        return uniform(generator);
    }

    void ReadGraphFile(string filename)
    {
        ifstream fin(filename);
        if (!fin.is_open()) {
            throw std::exception("Can't open the file");
        }
        string line;
        int vertices = 0, edges = 0;
        while (getline(fin, line))
        {
            if (line[0] == 'c')
            {
                continue;
            }

            stringstream line_input(line);
            char command;
            if (line[0] == 'p')
            {
                string type;
                line_input >> command >> type >> vertices >> edges;
                neighbour_sets.resize(vertices);
                colors.resize(vertices);
            }
            else
            {
                int start, finish;
                line_input >> command >> start >> finish;
                // Edges in DIMACS file can be repeated, but it is not a problem for our sets
                neighbour_sets[start - 1].insert(finish - 1);
                neighbour_sets[finish - 1].insert(start - 1);
            }
        }
    }

    void GreedyGraphColoring()
    {
        vector<pair<int, int>> degrees(neighbour_sets.size());
        for (int i = 0; i < degrees.size(); ++i) {
            degrees[i] = {i, neighbour_sets[i].size()};
        }

        std::sort(degrees.begin(), degrees.end(), [](auto& p1, auto& p2) {
            return p1.second > p2.second;
        });

// This solution gave good color reduction for the latin_square_10.col;
/*        while (! degrees.empty())
        {
            int index = GetRandom(0, degrees.size() / 3);
            auto& d = degrees[index]; */

        for (auto& d: degrees) {
            int vertex = d.first;
            vector<bool> usedColors(d.second + 1, false);
            for (int neighbour: neighbour_sets[vertex]) {
                int nColor = colors[neighbour];
                if (nColor > 0 && nColor <= d.second + 1)
                    usedColors[nColor - 1] = true;
            }

            int c = 0;
            while (usedColors[c]) {
                c++;
            }
            colors[vertex] = c + 1;
            maxcolor = c + 1 > maxcolor ? c + 1 : maxcolor;
            
            /* swap(degrees[degrees.size() - 1], degrees[index]);
            degrees.pop_back(); */
        }
    }

    bool Check()
    {
        for (size_t i = 0; i < neighbour_sets.size(); ++i)
        {
            if (colors[i] == 0)
            {
                cout << "Vertex " << i + 1 << " is not colored\n";
                return false;
            }
            for (int neighbour : neighbour_sets[i])
            {
                if (colors[neighbour] == colors[i])
                {
                    cout << "Neighbour vertices " << i + 1 << ", " << neighbour + 1 <<  " have the same color\n";
                    return false;
                }
            }
        }
        return true;
    }

    int GetNumberOfColors()
    {
        return maxcolor;
    }

    const vector<int>& GetColors()
    {
        return colors;
    }

private:
    vector<int> colors;
    int maxcolor = 1;
    vector<unordered_set<int>> neighbour_sets;
};

int main()
{
    const string TEST_PATH = "C:\\Projects\\hse_algorithms_course\\test\\"; //  Set the path to the direectory with graphs' files
    vector<string> files = { "myciel3.col", "myciel7.col", "latin_square_10.col", "school1.col", "school1_nsh.col",
        "mulsol.i.1.col", "inithx.i.1.col", "anna.col", "huck.col", "jean.col", "miles1000.col", "miles1500.col",
        "fpsol2.i.1.col", "le450_5a.col", "le450_15b.col", "le450_25a.col", "games120.col",
        "queen11_11.col", "queen5_5.col" };
    ofstream fout("color.csv");
    fout << "Instance; Colors; Time (sec); Color classes\n";
    cout << "Instance; Colors; Time (sec); Color classes\n";
    for (string file : files)
    {
        ColoringProblem problem;
        try
        {
            problem.ReadGraphFile(TEST_PATH + file);
        }
        catch(const std::exception& e)
        {
            std::cerr << e.what() << '\n';
        }
        clock_t start = clock();
        problem.GreedyGraphColoring();
        if (! problem.Check())
        {
            fout << "*** WARNING: incorrect coloring: ***\n";
            cout << "*** WARNING: incorrect coloring: ***\n";
        }

        int nColors = problem.GetNumberOfColors();
        fout << file << "; " << nColors << "; " << double(clock() - start) / CLOCKS_PER_SEC << "; ";
        cout << file << "; " << nColors << "; " << double(clock() - start) / CLOCKS_PER_SEC << "; ";
        auto& colors = problem.GetColors();
        
        vector<vector<int>> colorClasses(nColors);
        for (int i = 0; i < colors.size(); ++i) {
            colorClasses[colors[i] - 1].push_back(i + 1);
        }

        // Print the colors classes and write to csv file
        for (auto& colorClass: colorClasses) {
            fout << "{";
            // cout << "{";
            for (int i = 0; i < colorClass.size(); ++i) {
                fout << colorClass[i];
                // cout << colorClass[i];
                
                if (i + 1 < colorClass.size()) {
                    fout << ", ";
                    // cout << ", ";
                }
            }
            fout << "}; ";
            // cout << "}; ";
        }
        fout << "\n";
        cout << "\n";
    }
    fout.close();
    return 0;
}

/*
Computational results

Instance; Colors; Time (sec); Color classes
myciel3.col; 4; 0; {1, 3, 11}; {2, 4, 7, 9}; {5, 6, 10}; {8}; 
myciel7.col; 8; 0.001; {2, 4, 11, 23, 47, 95, 191}; {1, 3, 6, 8, 48, 50, 53, 55, 70, 94, 96, 98, 101, 103, 118, 142, 143, 145, 148, 150, 154, 156, 159, 161, 165, 166, 168, 171, 173, 177, 179, 182, 184, 188, 189}; {5, 7, 10, 25, 28, 30, 33, 36, 39, 41, 44, 46, 97, 100, 102, 105, 120, 123, 124, 125, 128, 131, 134, 135, 136, 139, 141, 144, 147, 149, 152, 167, 170, 172, 175, 178, 181, 183, 186, 190}; {9, 13, 14, 15, 18, 19, 20, 27, 32, 37, 38, 42, 43, 51, 56, 60, 61, 62, 65, 66, 67, 74, 79, 83, 84, 85, 88, 89, 90, 99, 104, 108, 109, 110, 113, 114, 115, 122, 127, 132, 133, 137, 138, 146, 151, 155, 157, 160, 162, 169, 174, 180, 185}; {12, 16, 22, 24, 34, 35, 45, 52, 58, 59, 63, 69, 71, 75, 81, 82, 86, 92, 106, 107, 111, 117, 119, 129, 130, 140, 153, 158, 164, 176, 187}; {17, 26, 29, 31, 40, 64, 73, 76, 77, 78, 80, 87, 91, 112, 121, 126}; {21, 49, 54, 57, 68, 72, 116, 163}; {93}; 
latin_square_10.col; 213; 0.031; {1, 92, 183, 274, 371, 462, 553, 651, 742, 841}; {2, 91, 184, 273, 380, 472, 561, 643, 732, 850}; {3, 94, 181, 272, 391, 479, 570, 668, 759, 821}; {4, 93, 182, 271, 400, 489, 578, 660, 749, 830}; {5, 96, 187, 278, 411, 502, 593, 691, 782, 881}; {6, 95, 188, 277, 420, 512, 601, 683, 772, 890}; {7, 98, 185, 276, 431, 519, 610, 708, 799, 861}; {8, 97, 186, 275, 440, 529, 618, 700, 789, 870}; {9, 443, 534, 625, 641, 831}; {10, 101, 192, 283, 362, 453, 544}; {11, 100, 193, 282, 379, 634, 723}; {12, 103, 190, 281, 478, 667, 812}; {13, 102, 191, 280, 577, 748, 829}; {14, 105, 196, 287}; {15, 104, 197, 286}; {16, 107, 194, 285}; {17, 106, 195, 284}; {18, 442, 535, 624, 633, 722, 840}; {19, 110, 201, 292, 361, 642, 733}; {20, 109, 202, 291, 370, 463, 552}; {21, 112, 199, 290, 569, 758, 811}; {22, 111, 200, 289, 488, 659, 820}; {23, 114, 205, 296}; {24, 113, 206, 295}; {25, 116, 203, 294}; {26, 115, 204, 293}; {27, 445, 532, 623, 658}; {28, 119, 210, 301, 452, 832}; {29, 118, 211, 300, 551, 849}; {30, 121, 208, 299, 382, 469, 560}; {31, 120, 209, 298, 399, 650, 739}; {32, 123, 214, 305}; {33, 122, 215, 304}; {34, 125, 212, 303}; {35, 124, 213, 302}; {36, 444, 533, 622}; {37, 128, 219, 310, 543}; {38, 127, 220, 309}; {39, 130, 217, 308, 381}; {40, 129, 218, 307, 390, 568}; {41, 132, 223, 314}; {42, 131, 224, 313}; {43, 134, 221, 312}; {44, 133, 222, 311}; {45, 447, 538, 629, 681, 871}; {46, 137, 228, 319}; {47, 136, 229, 318}; {48, 139, 226, 317}; {49, 138, 227, 316}; {50, 141, 232, 323, 402, 493, 584}; {51, 140, 233, 322, 419, 674, 763}; {52, 143, 230, 321, 518, 707, 852}; {53, 142, 231, 320, 617, 788, 869}; {54, 446, 539, 628, 673, 762, 880}; {55, 146, 237, 328}; {56, 145, 238, 327}; {57, 148, 235, 326}; {58, 147, 236, 325}; {59, 150, 241, 332, 401, 682, 773}; {60, 149, 242, 331, 410, 503, 592}; {61, 152, 239, 330, 609, 798, 851}; {62, 151, 240, 329, 528, 699, 860}; {63, 449, 536, 627, 698}; {64, 155, 246, 337}; {65, 154, 247, 336}; {66, 157, 244, 335}; {67, 156, 245, 334}; {68, 159, 250, 341, 492, 872}; {69, 158, 251, 340, 591, 889}; {70, 161, 248, 339, 422, 509, 600}; {71, 160, 249, 338, 439, 690, 779}; {72, 448, 537, 626}; {73, 164, 255, 346}; {74, 163, 256, 345}; {75, 166, 253, 344}; {76, 165, 254, 343}; {77, 168, 259, 350, 583}; {78, 167, 260, 349}; {79, 170, 257, 348, 421}; {80, 169, 258, 347, 430, 608}; {81, 631, 724, 823}; {82, 173, 264, 355}; {83, 172, 265, 354}; {84, 175, 262, 353}; {85, 174, 263, 352}; {86, 177, 268, 359}; {87, 176, 269, 358}; {88, 179, 266, 357}; {89, 178, 267, 356}; {90, 433, 524, 615}; {99, 378, 461, 554, 714, 807, 833}; {108, 369, 454, 542, 716, 804}; {117, 396, 481, 572}; {126, 387, 470, 559, 713, 802}; {135, 414, 496, 587, 712, 803}; {144, 405, 487, 579}; {153, 432, 514, 605}; {162, 423, 505, 596}; {171, 451, 545, 824}; {180, 368, 455, 541, 794, 857}; {189, 372, 468, 555, 666, 753, 898}; {198, 363, 459, 546}; {207, 364, 547, 675, 899}; {216, 365, 548, 684, 900}; {225, 366, 693, 776, 893}; {234, 367, 702, 785}; {243, 373, 550, 757, 892}; {252, 374, 557}; {261, 375, 556, 781}; {270, 376, 467, 701, 784, 883}; {279, 377, 464, 558, 801, 864}; {288, 383, 471, 567, 679, 774, 846}; {297, 388, 482, 576, 635, 729}; {306, 384, 473, 783}; {315, 385, 474, 792, 873}; {324, 386, 475, 710, 882}; {333, 389, 480, 738, 837}; {342, 392, 483}; {351, 393, 484}; {360, 394, 575, 694, 791, 818}; {395, 486, 571, 711, 797, 896}; {397, 490, 581, 725, 842}; {398, 491, 580, 644, 859}; {403, 494, 582, 790}; {404, 495, 793}; {406, 497, 588}; {407, 498, 586, 730}; {408, 499, 590}; {409, 500, 594, 661, 756, 855}; {412, 501, 589, 787, 868}; {413, 504, 795, 894}; {415, 506, 597}; {416, 507, 595}; {417, 508, 599}; {418, 510, 602, 662, 755, 863}; {424, 515, 606}; {425, 516, 604}; {426, 517, 611, 746, 845}; {427, 520, 612, 663}; {428, 521, 607, 760, 886}; {429, 522, 766}; {434, 523, 616, 640, 813}; {435, 526, 613, 838}; {436, 525, 614}; {437, 530, 619}; {438, 527, 620, 680, 853}; {441, 715, 806}; {450, 703, 796}; {456, 549, 645}; {457, 646, 731, 876}; {458, 647, 734, 888}; {460, 649, 741}; {465, 636, 727}; {466, 637, 726}; {476, 562, 638, 887}; {477, 563, 639, 897}; {485, 573, 656, 744}; {511, 598, 655, 877}; {513, 648, 736}; {531, 657, 740}; {540, 665, 750, 885}; {564, 664}; {565, 670, 844}; {566, 671, 764}; {574, 632, 835}; {585, 653, 747}; {603, 652}; {621, 654}; {630, 669, 836}; {672, 761}; {676, 767}; {677, 768}; {678, 769}; {685, 777}; {686, 775}; {687, 778}; {688, 780}; {689, 847}; {692, 884}; {695, 786}; {696, 834}; {697, 839}; {704, 800, 826}; {705}; {706, 843}; {709, 865}; {717, 805}; {718, 809}; {719, 808}; {720}; {721, 848}; {728, 827}; {735, 816}; {737, 854}; {743, 815}; {745, 817}; {751, 814}; {752, 879}; {754, 862}; {765, 819}; {770, 878}; {771, 825}; {810}; {822}; {828}; {856}; {858}; {866}; {867}; {874}; {875}; {891}; {895}; 
school1.col; 34; 0.001; {13, 86, 104, 105, 138, 162, 168, 188, 194, 229, 236, 241, 313, 315, 316, 357, 361, 362, 363, 370, 371, 372, 373, 374, 375}; {99, 136, 137, 140, 185, 193, 284, 285, 314, 353, 354, 355, 364, 365, 366, 367, 368, 369, 376, 377, 378, 380}; {2, 6, 40, 66, 74, 91, 96, 111, 124, 152, 183, 195, 221, 230, 234, 250, 261, 274, 280, 305, 326, 329, 351, 360, 384, 385}; {5, 22, 28, 44, 117, 119, 149, 153, 159, 186, 233, 238, 309, 328, 382}; {10, 19, 57, 101, 114, 116, 121, 142, 155, 156, 167, 187, 197, 237, 331, 381}; {3, 18, 52, 110, 131, 145, 161, 176, 203, 228, 262, 330, 383}; {9, 21, 39, 51, 100, 118, 125, 150, 158, 171, 198, 231, 240, 306, 379}; {7, 20, 32, 56, 85, 120, 179, 232, 252, 340}; {27, 48, 64, 103, 127, 144, 175, 178, 191, 201, 211, 253}; {35, 50, 71, 106, 123, 160, 180, 200, 302, 323, 327, 339}; {16, 30, 33, 62, 98, 115, 128, 141, 151, 154, 170, 226, 235, 276, 282}; {59, 78, 81, 92, 108, 122, 163, 242, 251, 287, 342, 345}; {14, 34, 126, 143, 172, 210, 222, 246, 272, 278, 301, 318}; {68, 87, 97, 133, 189, 208, 247, 263, 269, 290, 319, 356}; {8, 37, 83, 93, 132, 139, 196, 202, 209, 214, 249, 325}; {12, 70, 75, 84, 112, 225, 275, 277, 281, 321, 358}; {31, 55, 67, 113, 129, 157, 165, 192, 227, 239, 254, 267, 289, 308}; {38, 61, 79, 243, 255, 260, 338}; {36, 46, 60, 77, 206, 219, 268, 288, 295, 311, 324, 343, 346}; {42, 72, 89, 174, 266, 286, 320, 333, 336, 352}; {24, 65, 73, 135, 148, 164, 258, 273, 279, 307, 334}; {47, 53, 58, 88, 130, 147, 223, 248, 265, 291, 293, 341, 344}; {54, 76, 90, 95, 207, 212, 218, 270, 271, 296, 312, 349, 359}; {4, 41, 45, 49, 107, 190, 199, 245, 259, 310, 348}; {26, 29, 109, 134, 182, 264, 292, 304}; {1, 23, 69, 94, 169, 204, 217, 220, 224, 300}; {17, 25, 43, 63, 173, 215, 256, 283, 337}; {82, 102, 146, 177, 298, 317, 332, 335}; {80, 166, 299, 303, 322}; {11, 181, 205, 244, 257, 294, 347}; {15, 297}; {184, 216}; {350}; {213}; 
school1_nsh.col; 33; 0; {2, 5, 22, 54, 105, 112, 124, 136, 137, 142, 153, 159, 183, 186, 193, 229, 234, 236, 238, 241, 284, 309, 313, 316, 328}; {1, 13, 40, 91, 103, 104, 138, 155, 156, 174, 195, 233, 237, 285, 315, 351}; {3, 19, 35, 44, 75, 86, 99, 113, 121, 161, 168, 188, 194, 204, 228, 231, 245, 314, 344, 348}; {9, 21, 31, 39, 51, 57, 65, 100, 109, 125, 150, 157, 171, 185, 240, 306}; {8, 18, 43, 87, 94, 110, 145, 170, 176, 179, 187, 273, 279, 330}; {56, 77, 84, 141, 152, 154, 162, 235, 250, 265, 329}; {7, 20, 32, 55, 85, 111, 120, 139, 232, 252, 261, 340}; {23, 37, 64, 127, 140, 144, 178, 182, 191, 201, 253, 327}; {50, 106, 123, 167, 177, 189, 200, 302, 323, 331, 339, 347}; {4, 52, 78, 108, 122, 169, 180, 220, 242, 251, 300, 345}; {16, 30, 92, 115, 117, 119, 128, 151, 318, 341}; {26, 49, 126, 143, 175, 210, 246, 272, 278, 301, 326}; {10, 38, 83, 114, 132, 196, 197, 208, 249, 321}; {6, 97, 118, 129, 165, 192, 198, 239, 254, 263, 308}; {61, 107, 133, 149, 205, 223, 247, 275, 277, 281, 338}; {14, 73, 93, 116, 199, 215, 227, 243, 255, 260, 286, 299, 334, 337}; {46, 74, 79, 89, 173, 206, 287, 311, 319, 342}; {27, 135, 148, 190, 202, 203, 258, 295, 307, 324}; {42, 81, 146, 207, 214, 266, 271, 297, 320}; {34, 70, 76, 98, 225, 274, 280, 305}; {47, 71, 88, 147, 158, 248, 291, 293, 325}; {28, 36, 66, 72, 90, 95, 257, 333}; {45, 60, 172, 218, 259, 268, 288, 296, 310, 343, 346, 349}; {17, 25, 29, 41, 59, 69, 82, 131, 166, 317}; {12, 53, 62, 102, 184, 276, 282, 298, 304, 332, 335, 350}; {33, 48, 58, 67, 101, 130, 216, 292}; {80, 134, 160, 163, 244, 264, 290, 294, 303, 322}; {11, 68, 224, 230, 269, 336, 352}; {15, 24, 217, 221, 262, 270, 312}; {96, 164, 181, 213, 219, 256, 267, 289}; {63, 212, 222, 283}; {209, 226}; {211}; 
mulsol.i.1.col; 49; 0; {1, 17, 58, 61, 66, 69, 70, 72, 76, 78, 79, 81, 82, 84, 86, 89, 92, 94, 95, 97, 98, 100, 101, 103, 105, 106, 110, 113, 115, 116, 119, 122, 123, 124, 132, 133, 134, 140, 141, 143, 155, 156, 158, 159, 167, 168, 170, 171, 172, 175, 179, 180, 182, 183, 185, 186, 188, 190, 193, 194, 196}; {2, 26}; {39, 47}; {40, 48}; {41, 49}; {3, 25}; {42, 50}; {43, 51}; {14, 24}; {9, 44}; {13, 23}; {10, 45}; {16, 46}; {12, 59}; {11, 56}; {52, 57}; {8, 60}; {7, 22}; {21, 53}; {6, 20}; {19, 54}; {5, 62, 189}; {32, 55}; {15, 31}; {4, 30}; {29, 65, 191, 192}; {28, 67}; {27, 68, 75}; {18, 71}; {63, 80, 187, 197}; {38, 64, 74, 184}; {77, 87, 121, 125, 126, 127, 128, 129, 130, 131, 135, 136, 137, 139, 145, 153, 154, 160, 164, 166, 195}; {34, 85, 138, 149, 150, 151, 161, 163, 165, 173, 174, 176, 177, 178}; {83, 147, 162}; {88}; {90, 99}; {104}; {91}; {107}; {93, 111}; {96, 112}; {102, 114}; {108, 117}; {118}; {109, 120}; {33, 73}; {35, 36, 37, 142}; {144, 157, 169, 181}; {146, 148, 152}; 
inithx.i.1.col; 54; 0.001; {1, 17, 35, 92, 93, 94, 97, 101, 104, 107, 110, 111, 114, 118, 120, 122, 123, 124, 125, 126, 127, 128, 129, 131, 135, 136, 138, 140, 144, 146, 147, 148, 149, 150, 151, 153, 154, 155, 156, 157, 158, 160, 161, 164, 167, 169, 171, 172, 176, 177, 178, 179, 181, 184, 189, 194, 195, 198, 203, 206, 211, 213, 216, 218, 221, 223, 226, 228, 231, 235, 237, 243, 244, 246, 247, 248, 249, 250, 252, 259, 260, 263, 265, 269, 273, 275, 279, 281, 284, 286, 289, 291, 293, 294, 295, 296, 298, 299, 300, 301, 303, 308, 310, 311, 315, 316, 317, 319, 320, 322, 324, 326, 330, 332, 333, 335, 341, 343, 346, 348, 350, 352, 354, 355, 357, 359, 361, 363, 367, 370, 375, 380, 381, 383, 386, 388, 390, 391, 392, 394, 395, 396, 398, 399, 403, 406, 408, 410, 411, 412, 413, 415, 416, 417, 419, 424, 426, 427, 429, 433, 434, 436, 438, 439, 440, 447, 449, 450, 456, 457, 459, 462, 464, 468, 469, 470, 471, 475, 483, 484, 488, 489, 490, 493, 495, 497, 499, 502, 503, 505, 509, 511, 512, 514, 515, 516, 517, 519, 520, 522, 523, 524, 526, 527, 528, 529, 531, 532, 533, 535, 536, 537, 538, 540, 548, 551, 553, 554, 555, 556, 558, 559, 561, 563, 568, 570, 571, 578, 580, 581, 582, 586, 590, 597, 600, 607, 609, 614, 618, 622, 623, 625, 629, 632, 634, 637, 639, 643, 650, 653, 661, 666, 667, 668, 669, 671, 677, 678, 681, 683, 685, 686, 687, 688, 690, 691, 692, 694, 699, 701, 702, 706, 710, 714, 715, 717, 719, 720, 723, 725, 727, 736, 737, 738, 740, 741, 742, 744, 749, 752, 753, 755, 757, 759, 760, 762, 763, 764, 767, 769, 770, 773, 774, 776, 781, 783, 788, 791, 792, 793, 795, 797, 799, 800, 802, 805, 806, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 824, 828, 831, 833, 834, 835, 836, 838, 839, 840, 843, 848, 850, 851, 854, 860, 862, 863}; {2, 27}; {3, 28}; {73, 81}; {74, 82}; {75, 83}; {12, 29}; {11, 30}; {13, 31}; {14, 32}; {76, 84}; {77, 85}; {78, 86}; {79, 87}; {80, 88}; {15, 26}; {16, 25}; {89, 96, 99, 102}; {24, 112}; {10, 23}; {9, 22}; {8, 21}; {7, 20}; {6, 19}; {5, 18}; {4, 47, 100, 103, 106, 108}; {48, 90, 113, 180, 182, 186, 190, 191, 193, 478, 481, 482, 501, 560, 638, 663, 664, 680, 729, 731, 734, 735, 758, 798, 807, 808}; {49, 91, 95, 351, 430, 437, 441, 448, 451, 452, 454, 455, 458, 463, 466, 467, 472, 473, 476, 477, 479, 496, 500, 504, 506, 521, 579, 616, 619, 620, 621, 640, 656, 658, 707, 713, 730, 732, 733}; {109, 116, 117, 183, 185, 187, 192, 445, 446, 453, 460, 465, 474, 492, 498, 507, 508, 513, 530, 584, 588, 601, 602, 603, 604, 651, 654, 655, 659, 662, 708, 711, 712}; {36, 39, 54, 121, 139, 196, 199, 200, 202, 207, 208, 210, 214, 217, 219, 220, 224, 227, 229, 232, 234, 236, 241, 264, 267, 270, 272, 327, 328, 331, 340, 344, 349, 442, 494, 510, 525, 534, 583, 593, 594, 605, 612, 615, 652, 660, 709, 841}; {33, 40, 98, 115, 141, 143, 188, 197, 201, 204, 205, 212, 215, 222, 225, 230, 233, 239, 240, 245, 271, 290, 323, 329, 342, 358, 371, 372, 373, 378, 379, 518, 585, 587, 592, 595, 598, 606, 610, 611, 613, 617, 856, 857, 858, 861}; {119, 132, 142, 159, 209, 266, 282, 283, 288, 362, 364, 365, 368, 374, 376, 377, 589, 591, 596, 599, 608, 855, 859}; {133, 162, 163, 165, 168, 175, 238, 268, 277, 278, 360, 366, 369}; {37, 41, 134, 170, 174, 258, 274, 276, 280, 287, 325, 336, 347, 823}; {38, 52, 57, 166, 321, 334, 545, 635, 648, 657, 665, 825}; {42, 56, 71, 487, 491, 626, 739}; {55, 544, 627, 641, 646, 647, 649, 724, 779, 780, 790, 803, 804, 809, 810}; {67, 105, 480, 485, 486, 543, 628, 633, 644, 645, 672, 718}; {53, 242, 384, 542, 630, 631, 636, 642, 674}; {60, 65, 69, 130, 251, 337, 345, 353, 385, 389, 539}; {43, 137, 152, 253, 339, 356, 541, 676, 801, 827}; {34, 44, 50, 62, 145, 254, 338, 393, 443, 675, 721, 726, 765, 768, 771, 826}; {45, 46, 51, 58, 68, 173, 382, 387, 444, 461, 547, 722, 728, 747, 748, 751, 772}; {63, 66, 255, 546, 673, 745, 746, 750, 754, 766, 786, 787, 794, 796, 829, 837}; {72, 256, 402, 549, 557, 670, 743, 756, 777, 778, 782, 785, 789, 830, 846, 847, 864}; {70, 257, 401, 550, 566, 567, 569, 679, 689, 761, 775, 784, 832, 842, 845, 853}; {59, 61, 261, 297, 397, 552, 562, 565, 572, 682, 697, 698, 703, 844}; {262, 306, 307, 309, 400, 564, 576, 684, 693, 696, 700, 849}; {285, 292, 302, 305, 312, 405, 414, 574, 695, 704, 852}; {304, 313, 404, 575, 716}; {318, 407, 422, 423, 428, 573, 705}; {314, 409, 420, 421, 425, 624}; {64, 418, 577}; {431, 432, 435}; 
anna.col; 11; 0; {1, 2, 3, 5, 14, 17, 18, 22, 24, 30, 38, 47, 48, 52, 56, 61, 65, 66, 71, 77, 86, 98, 102, 110, 115, 117, 119, 120, 122, 125, 126, 129, 133, 134, 137}; {4, 8, 9, 10, 12, 15, 23, 25, 27, 29, 31, 34, 36, 39, 40, 41, 42, 43, 44, 49, 53, 54, 55, 58, 60, 63, 68, 69, 75, 78, 82, 84, 87, 88, 90, 96, 97, 101, 105, 107, 109, 111, 112, 113, 114, 121, 124, 128}; {7, 11, 16, 21, 28, 35, 50, 57, 59, 62, 67, 80, 89, 95, 103, 123, 127, 130, 131, 132}; {13, 37, 64, 70, 74, 79, 93, 100, 104, 106, 118}; {19, 26, 45, 46, 72, 76, 92, 94, 135}; {6, 51, 73, 138}; {32, 33, 136}; {20, 83, 85, 116}; {99, 108}; {81}; {91}; 
huck.col; 11; 0; {8, 26, 28, 33, 35, 37, 43, 55, 61, 63, 70, 71}; {3, 4, 5, 7, 15, 17, 24, 36, 44, 48, 51, 54, 65, 66, 72}; {16, 23, 32, 42, 45, 49, 52, 57, 58}; {1, 6, 18, 30, 41, 53}; {9, 21, 29, 62, 73, 74}; {2, 10, 22, 27, 31, 39, 40, 47}; {11, 12, 14, 34, 46, 60, 69}; {20, 38, 50, 67, 68}; {13, 19, 64}; {56, 59}; {25}; 
jean.col; 10; 0; {1, 8, 11, 12, 13, 16, 18, 21, 23, 24, 26, 32, 33, 34, 36, 37, 41, 49, 51, 52, 54, 65, 71, 74, 76, 80}; {3, 10, 14, 31, 43, 45, 48, 53, 56, 59, 61, 62, 67, 70, 72}; {2, 4, 15, 17, 28, 40, 42, 60, 78}; {5, 9, 25, 29, 30, 46, 57, 64, 75}; {6, 27, 39, 44, 66, 77}; {7, 20, 35, 63}; {19, 22, 55, 69}; {38, 47, 50, 58, 73}; {68}; {79}; 
miles1000.col; 43; 0; {27, 49, 51, 56, 82, 87}; {9, 16, 36, 72, 76, 106}; {4, 12, 22, 34, 88, 95}; {21, 37, 86, 121, 128}; {5, 17, 31, 60, 62}; {8, 23, 32, 104}; {3, 91, 103, 112}; {18, 33, 68, 119}; {44, 48, 59, 65, 92}; {26, 28, 35, 57}; {43, 47, 84, 124}; {29, 52, 63, 98}; {74, 77, 81, 107}; {40, 50, 93, 110}; {42, 54, 55, 126}; {11, 15, 80, 123}; {1, 66, 85}; {14, 41, 64}; {13, 99, 120}; {10, 108}; {96, 114}; {102, 115}; {75, 90}; {45, 67, 105}; {100, 111}; {83, 117, 122}; {2, 79}; {39, 127}; {7, 70}; {109, 113}; {69, 89, 97}; {71, 73, 118}; {20, 78}; {30, 101}; {19, 24}; {6, 94, 125}; {38}; {53}; {58}; {116}; {25}; {46}; {61}; 
miles1500.col; 73; 0; {54, 79}; {29, 110}; {77, 108}; {3, 27}; {63, 86, 109}; {39, 42, 95, 112}; {81, 128}; {15, 56, 74}; {49, 60, 117}; {50, 61, 80}; {9, 36, 105}; {21, 106, 114}; {22, 59, 90}; {1, 18, 82}; {8, 48}; {26, 102, 118}; {43, 104}; {78, 124}; {11, 125}; {5, 91}; {40, 68}; {4, 62}; {73, 85}; {17, 92}; {76}; {88}; {100}; {19}; {28, 37}; {101}; {47, 99}; {52, 87}; {35, 67}; {64, 121}; {51, 70}; {34, 55}; {66}; {122}; {57}; {53, 98}; {123}; {107}; {32, 115}; {126}; {7, 119}; {23, 97}; {31, 94}; {58, 103}; {33, 127}; {16, 75}; {12, 45}; {69, 72}; {65, 71}; {2, 120}; {89}; {14, 44}; {96}; {6}; {13}; {83}; {93}; {10}; {113}; {84}; {20}; {111}; {24}; {30}; {116}; {46}; {25}; {41}; {38}; 
fpsol2.i.1.col; 65; 0; {1, 17, 34, 35, 36, 37, 39, 40, 41, 42, 48, 49, 51, 52, 53, 54, 56, 57, 58, 60, 61, 65, 68, 69, 70, 71, 72, 73, 75, 109, 111, 112, 115, 118, 126, 127, 128, 131, 133, 134, 135, 139, 140, 142, 143, 144, 146, 148, 152, 153, 154, 155, 157, 158, 162, 164, 165, 167, 169, 173, 174, 175, 176, 177, 178, 179, 180, 181, 184, 186, 187, 188, 191, 192, 193, 194, 195, 196, 198, 199, 202, 205, 206, 207, 208, 209, 210, 211, 212, 215, 217, 227, 229, 231, 233, 235, 237, 243, 247, 253, 254, 256, 257, 260, 266, 268, 270, 272, 274, 278, 284, 285, 287, 288, 289, 290, 291, 292, 293, 294, 295, 298, 300, 301, 304, 306, 307, 309, 311, 312, 314, 316, 319, 320, 322, 323, 324, 326, 330, 332, 334, 335, 337, 341, 342, 345, 346, 347, 348, 349, 350, 352, 353, 354, 356, 357, 359, 361, 362, 363, 365, 367, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 381, 382, 385, 387, 389, 392, 396, 397, 399, 400, 403, 406, 408, 410, 414, 416, 417, 418, 419, 420, 422, 424, 425, 427, 428, 429, 430, 432, 435, 437, 439, 440, 442, 444, 446, 447, 448, 450, 453, 455, 456, 458, 461, 464, 466, 468, 472, 476, 477, 479, 481, 485, 487, 489, 492, 494, 495}; {2, 30}; {90, 98}; {91, 99}; {92, 100}; {93, 101}; {94, 102}; {13, 32}; {14, 31}; {95, 103}; {12, 27}; {16, 28}; {15, 29}; {104, 114}; {105, 108}; {106, 107}; {10, 117}; {9, 116}; {8, 110}; {7, 97}; {6, 96}; {5, 113}; {11, 26}; {4, 25}; {3, 24}; {23, 64, 163, 216, 280, 282, 283, 317, 318, 394, 395, 454, 473, 475, 493}; {22, 244, 246, 251, 252, 279, 281, 393, 423, 426, 474}; {21, 245, 248, 250}; {119, 249, 310}; {20}; {19}; {18}; {120, 296}; {124, 297}; {123, 299, 305}; {122, 303}; {76, 121}; {125, 302, 308, 313, 321}; {130, 168, 315}; {86, 129, 171}; {55, 79, 132, 170, 172}; {74, 80}; {33, 38}; {59, 138, 325, 460, 462, 465}; {47, 67, 141, 401, 404}; {50, 62, 137, 149, 480, 496}; {66, 258, 262, 267, 327, 459, 478, 482, 483, 486}; {136, 147, 150, 182, 329, 463, 467, 469, 484, 488, 491}; {145, 151, 183, 328, 338, 470, 490}; {45, 84, 156, 159, 189, 190, 333, 471}; {43, 85, 160, 185, 197, 336}; {63, 166, 200, 204, 213, 221, 222, 228, 331}; {81, 203, 220, 225, 238, 339}; {46, 161, 201, 219, 226, 239, 343}; {44, 82, 83, 214, 218, 232, 261, 265, 269, 340, 344, 351, 355, 358, 431}; {223, 230, 240, 259, 264, 275, 360, 434, 438}; {77, 78, 224, 234, 241, 263, 273, 276, 433}; {89, 236, 255, 271, 286, 366, 379, 436, 441}; {242, 277, 368, 380, 383, 386, 443, 449, 451}; {87, 384, 388, 390, 402, 407, 445}; {364, 398, 412, 457}; {391, 405, 411, 452}; {88, 409}; {413}; {415, 421}; 
le450_5a.col; 12; 0; {1, 6, 24, 31, 46, 55, 56, 60, 70, 81, 91, 92, 95, 126, 128, 146, 156, 161, 175, 180, 191, 200, 202, 210, 211, 213, 216, 218, 221, 224, 251, 261, 263, 264, 271, 276, 278, 285, 286, 290, 306, 309, 325, 339, 366, 377, 391, 396, 416, 424, 430, 435, 441}; {14, 17, 20, 21, 26, 32, 37, 40, 45, 51, 54, 64, 66, 85, 102, 104, 116, 135, 155, 157, 160, 166, 181, 190, 196, 206, 212, 214, 234, 239, 246, 250, 260, 282, 343, 360, 370, 372, 380, 384, 389, 393, 404, 421}; {3, 9, 12, 19, 23, 33, 36, 49, 61, 63, 74, 83, 86, 87, 88, 90, 108, 113, 118, 122, 130, 143, 148, 164, 178, 183, 188, 198, 201, 223, 227, 232, 237, 248, 259, 270, 279, 289, 291, 298, 324, 338, 347, 358, 363, 368, 403, 413, 414, 422, 423, 427}; {4, 35, 39, 43, 52, 53, 58, 59, 75, 103, 110, 115, 117, 140, 141, 151, 153, 154, 159, 167, 168, 169, 172, 174, 192, 197, 208, 215, 225, 240, 241, 256, 265, 268, 269, 273, 274, 297, 300, 305, 322, 330, 340, 342, 379, 385, 388, 394, 399, 411, 412, 417, 438, 446}; {5, 8, 16, 22, 38, 42, 65, 73, 78, 80, 94, 106, 119, 136, 142, 144, 152, 162, 186, 194, 195, 209, 226, 243, 249, 252, 253, 254, 257, 258, 262, 284, 294, 303, 318, 319, 327, 336, 345, 348, 351, 353, 359, 361, 373, 382, 402, 420, 432, 440}; {10, 15, 27, 34, 57, 71, 96, 98, 99, 105, 111, 120, 121, 124, 125, 138, 147, 184, 189, 193, 205, 220, 266, 280, 281, 288, 295, 296, 301, 310, 314, 315, 328, 350, 354, 357, 371, 398, 407, 409, 418, 434, 439, 447, 450}; {13, 18, 41, 47, 48, 62, 67, 77, 89, 112, 139, 165, 182, 185, 187, 207, 228, 229, 231, 233, 242, 267, 275, 277, 283, 292, 308, 311, 321, 329, 334, 335, 346, 355, 362, 365, 387, 392, 405, 410, 431, 436, 437, 444}; {29, 44, 69, 72, 79, 82, 101, 109, 114, 132, 133, 137, 145, 158, 177, 199, 219, 235, 245, 293, 307, 312, 326, 331, 333, 337, 367, 369, 381, 383, 386, 401, 406, 408, 419, 426, 445}; {2, 11, 84, 97, 100, 129, 131, 150, 170, 171, 176, 204, 217, 222, 236, 238, 244, 299, 302, 304, 313, 316, 323, 332, 341, 349, 352, 375, 378, 390, 425, 429, 433, 442, 443, 449}; {7, 28, 30, 50, 68, 107, 123, 127, 149, 173, 203, 230, 247, 255, 287, 317, 320, 344, 356, 364, 374, 376, 395, 415, 428}; {76, 93, 134, 163, 179, 272, 397, 400, 448}; {25}; 
le450_15b.col; 18; 0; {9, 14, 24, 32, 40, 51, 59, 72, 75, 92, 103, 107, 108, 114, 129, 131, 142, 150, 152, 184, 189, 200, 210, 213, 236, 287, 327, 347, 353, 356, 365, 391, 401, 407, 417, 425, 434, 438, 439, 444, 447}; {29, 33, 48, 49, 60, 68, 101, 111, 115, 117, 141, 157, 159, 177, 186, 192, 209, 216, 220, 231, 235, 255, 282, 291, 297, 301, 306, 316, 348, 357, 360, 381, 382, 392, 421, 440}; {27, 35, 50, 54, 58, 61, 91, 153, 179, 182, 183, 188, 227, 239, 279, 292, 322, 331, 359, 361, 390, 398, 399, 408, 409, 410, 413, 414, 429}; {3, 30, 34, 57, 74, 77, 88, 102, 137, 149, 215, 217, 221, 230, 238, 246, 270, 275, 290, 313, 338, 384, 405, 415, 419, 420, 441}; {11, 55, 86, 124, 130, 138, 167, 169, 198, 222, 247, 263, 288, 304, 323, 333, 334, 335, 343, 351, 354, 369, 386, 403, 422}; {4, 23, 38, 56, 82, 84, 94, 116, 164, 199, 202, 212, 228, 232, 234, 237, 242, 244, 283, 286, 336, 349, 352, 362, 368, 397, 400, 430}; {5, 10, 22, 28, 31, 64, 65, 127, 145, 154, 166, 176, 201, 219, 248, 264, 266, 280, 315, 318, 328, 346, 380, 423, 426, 433, 436, 442}; {45, 46, 62, 73, 76, 87, 100, 123, 133, 147, 194, 243, 258, 262, 269, 271, 295, 299, 307, 324, 341, 363, 374, 389, 448, 449}; {18, 21, 53, 66, 69, 80, 85, 93, 125, 143, 168, 190, 195, 251, 252, 261, 267, 274, 293, 294, 305, 308, 317, 366, 371, 412, 427, 431, 435}; {79, 98, 112, 132, 136, 140, 158, 160, 162, 165, 175, 178, 185, 191, 196, 208, 276, 281, 296, 302, 329, 332, 345, 370, 377, 393}; {1, 2, 15, 37, 70, 71, 96, 109, 121, 128, 155, 163, 170, 207, 256, 260, 289, 312, 319, 340, 350, 385, 402, 450}; {7, 13, 17, 36, 47, 63, 67, 90, 122, 134, 180, 204, 214, 229, 254, 272, 273, 284, 320, 358, 364, 375, 378, 379, 394, 406}; {16, 25, 26, 39, 42, 44, 97, 119, 126, 146, 148, 181, 206, 223, 225, 226, 241, 250, 278, 285, 321, 372, 373, 383, 387, 388, 416}; {41, 43, 78, 81, 89, 95, 113, 139, 172, 197, 205, 211, 218, 240, 253, 257, 259, 265, 310, 314, 325, 342, 376, 443}; {8, 20, 83, 110, 135, 144, 187, 193, 224, 245, 249, 277, 298, 300, 311, 339, 367, 396, 404, 432, 437, 445}; {19, 52, 99, 106, 120, 151, 156, 161, 171, 173, 174, 233, 268, 303, 326, 330, 355, 395, 411, 418, 446}; {6, 104, 105, 118, 203, 337, 344, 424}; {12, 309, 428}; 
le450_25a.col; 26; 0.001; {3, 13, 18, 30, 36, 41, 42, 47, 49, 68, 72, 80, 87, 107, 115, 116, 117, 118, 124, 125, 135, 139, 146, 151, 154, 166, 167, 179, 180, 211, 214, 220, 225, 235, 240, 242, 247, 268, 272, 278, 279, 285, 295, 299, 303, 314, 315, 316, 322, 323, 327, 350, 353, 360, 387, 403, 408, 420, 424, 431, 441}; {6, 15, 21, 24, 27, 52, 71, 108, 112, 148, 171, 190, 194, 212, 215, 232, 243, 244, 250, 267, 276, 298, 304, 305, 324, 340, 344, 349, 354, 359, 373, 396, 404, 412, 428, 433, 434, 436, 450}; {28, 45, 50, 69, 81, 94, 129, 130, 137, 140, 168, 196, 200, 208, 209, 222, 236, 253, 262, 325, 341, 389, 391, 393, 411, 437, 447}; {22, 25, 34, 35, 38, 53, 56, 77, 82, 95, 155, 176, 204, 218, 223, 249, 310, 330, 338, 362, 449}; {9, 51, 59, 64, 75, 101, 103, 170, 184, 210, 227, 241, 264, 288, 321, 328, 357, 421, 438}; {8, 46, 65, 74, 78, 86, 90, 99, 109, 145, 150, 159, 188, 233, 296, 386, 394, 399}; {4, 32, 61, 66, 83, 91, 185, 205, 226, 257, 331, 337, 376, 382, 410, 448}; {14, 29, 105, 133, 158, 217, 224, 237, 260, 311, 345, 370, 392, 395, 405, 417, 435}; {1, 16, 55, 113, 122, 132, 147, 189, 258, 289, 335, 339, 364, 414, 422}; {19, 31, 57, 84, 93, 97, 153, 173, 191, 202, 213, 254, 287, 317, 369, 390, 416}; {60, 62, 67, 85, 89, 119, 136, 144, 197, 201, 206, 231, 251, 269, 307, 355, 358, 372}; {44, 54, 73, 111, 138, 165, 181, 273, 291, 294, 312, 326, 363, 379, 388, 406, 423, 445}; {20, 23, 33, 121, 143, 172, 187, 193, 216, 252, 255, 271, 283, 297, 301, 313, 356, 371, 425, 427}; {2, 5, 11, 17, 26, 63, 98, 110, 114, 126, 161, 174, 221, 274, 300, 309, 329, 429, 432}; {88, 127, 128, 156, 160, 162, 320, 336, 385, 402, 426}; {37, 40, 76, 104, 141, 163, 280, 334, 343, 367, 368, 383, 439}; {92, 120, 134, 182, 198, 230, 256, 263, 275, 282, 346, 375}; {100, 102, 175, 239, 281, 318, 319, 351, 398, 446}; {96, 131, 183, 195, 246, 270, 290, 293, 308, 380, 444}; {39, 229, 238, 333, 361, 409, 413, 418}; {43, 58, 157, 169, 245, 248, 302, 342, 366, 400, 442}; {12, 70, 142, 219, 228, 259, 266, 277, 352, 374, 378, 401}; {7, 10, 48, 106, 186, 199, 261, 265, 365, 397, 415, 419}; {79, 123, 152, 164, 178, 192, 207, 286, 306, 332, 347, 407}; {149, 177, 203, 234, 284, 292, 348, 381, 384, 430, 440, 443}; {377}; 
games120.col; 9; 0; {7, 13, 15, 19, 31, 34, 38, 44, 49, 78, 84, 89, 92, 94, 100, 101, 111, 119}; {3, 4, 6, 10, 17, 23, 32, 51, 58, 62, 65, 66, 77, 88, 98, 109, 113}; {14, 16, 20, 29, 30, 45, 59, 68, 76, 85, 91, 97, 104, 107, 115, 116, 120}; {1, 2, 9, 12, 25, 26, 27, 36, 37, 46, 53, 60, 61, 79, 103, 106, 114}; {11, 18, 24, 28, 48, 50, 56, 57, 64, 67, 69, 80, 82, 95, 110, 117}; {33, 35, 39, 47, 54, 55, 63, 70, 71, 72, 74, 105, 108, 118}; {5, 22, 40, 41, 43, 52, 75, 86, 93, 99, 112}; {21, 42, 73, 81, 87, 96, 102}; {8, 83, 90}; 
queen11_11.col; 17; 0; {9, 23, 38, 52, 61, 70, 84, 99, 113}; {30, 37, 51, 58, 72, 86, 93}; {20, 33, 39, 48, 62, 71, 85}; {19, 28, 42, 47, 60, 73, 81, 98}; {3, 12, 31, 40, 49, 57, 74, 83, 92}; {18, 25, 41, 50, 59, 75, 82, 120}; {1, 17, 26, 35, 54, 63, 88, 91, 106}; {4, 21, 27, 53, 66, 80, 94, 107, 112}; {29, 36, 55, 64, 68, 87, 103, 111}; {8, 15, 24, 43, 69, 95, 104, 121}; {7, 14, 32, 46, 77, 78, 96, 105, 119}; {16, 44, 45, 65, 79, 97, 102, 116}; {6, 22, 34, 76, 90, 108, 115}; {5, 13, 89, 110, 114}; {10, 67, 101, 117}; {2, 56, 109, 118}; {11, 100}; 
queen5_5.col; 7; 0; {2, 10, 13, 16, 24}; {5, 7, 14, 23}; {1, 8, 15, 17}; {9, 12, 20}; {4, 11, 18, 25}; {3, 6, 19, 22}; {21}; 
*/